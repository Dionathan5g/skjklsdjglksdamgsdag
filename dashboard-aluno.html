<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Aluno - Sistema Escolar</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Menu de Acessibilidade -->
    <div class="accessibility-menu">
        <button class="accessibility-toggle">
            ‚ôø Acessibilidade
        </button>
        <div class="accessibility-options" id="accessibilityOptions">
            <a href="#" onclick="toggleAccessibility('daltonismo')">Modo Dalt√¥nico</a>
            <a href="#" onclick="toggleAccessibility('preto-e-branco')">Preto e Branco</a>
            <a href="#" onclick="toggleAccessibility('nenhum')">Restaurar Padr√£o</a>
        </div>
    </div>

    <!-- Legendas de Acessibilidade -->
    <button class="legend-toggle" onclick="toggleLegend()">Ver Legenda (Daltonismo)</button>
    <div class="daltonismo-legend" id="daltonismoLegend">
        <button class="legend-close-btn" onclick="toggleLegend()" aria-label="Fechar legenda">√ó</button>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #0066cc;">‚òÖ</div>
            <span class="legend-text">Excelente</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666666;">‚óè</div>
            <span class="legend-text">Bom</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #cc6600;">‚ñ≤</div>
            <span class="legend-text">Regular / Aten√ß√£o</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #000000;">‚úñ</div>
            <span class="legend-text">Insatisfat√≥rio</span>
        </div>
    </div>

    <button class="pb-legend-toggle" onclick="togglePbLegend()">Ver Legenda (P&B)</button>
    <div class="pb-legend" id="pbLegend">
        <button class="legend-close-btn" onclick="togglePbLegend()" aria-label="Fechar legenda">√ó</button>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666;">‚ñ†</div>
            <span class="legend-text">Excelente</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666;">‚óè</div>
            <span class="legend-text">Bom</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666;">‚ñ≤</div>
            <span class="legend-text">Regular / Aten√ß√£o</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666;">‚úñ</div>
            <span class="legend-text">Insatisfat√≥rio</span>
        </div>
    </div>

    <!-- Elementos Decorativos removidos -->

    <div class="app-container">
        <!-- DASHBOARD ALUNO -->
        <div class="page active" id="dashboardAlunoPage">
            <div class="main-layout">
                <nav class="sidebar">
                    <!-- Logo ProJK -->
                    <div class="projk-logo-container" style="padding: 20px 15px; border-bottom: 2px solid rgba(52, 152, 219, 0.2); margin-bottom: 20px;">
                        <div class="projk-logo" style="font-size: 36px;">
                            <span class="logo-pro">Pro</span>
                            <span class="logo-j">J</span>
                            <span class="logo-k">K</span>
                            <span class="logo-dot">‚óè</span>
                        </div>
                        <p class="logo-subtitle" style="font-size: 12px; margin-top: 5px;">Sistema Escolar</p>
                    </div>
                    <div class="menu-item active" onclick="showAlunoSection('notas')">
                        <div class="menu-icon"><i class="fas fa-chart-bar"></i></div>
                        <span>Meu Boletim</span>
                    </div>

                    <div class="menu-item" onclick="showAlunoSection('calendario')">
                        <div class="menu-icon"><i class="fas fa-calendar"></i></div>
                        <span>Calend√°rio</span>
                    </div>

                    <div class="menu-item" onclick="showAlunoSection('perfil')">
                        <div class="menu-icon"><i class="fas fa-user"></i></div>
                        <span>Meu Perfil</span>
                    </div>

                    <div class="menu-item" onclick="logout()">
                        <div class="menu-icon"><i class="fas fa-sign-out-alt"></i></div>
                        <span>Sair</span>
                    </div>
                </nav>

                <main class="main-content">
                    <div id="alunoNotasSection">
                        <div class="professor-dashboard-container">
                            <div class="professor-header">
                                <h1 class="professor-title">Meu Boletim Escolar</h1>
                                <div class="header-badges" style="display: flex; gap: 10px; align-items: center;">
                                    <div class="bd-projk" style="background: var(--primary-yellow); color: #000; padding: 8px 16px; border-radius: 20px; font-weight: 800; font-size: 18px; letter-spacing: 1px;">
                                        <span class="logo-j" style="color: #000;">J</span><span class="logo-k" style="color: var(--primary-blue);">K</span>
                                    </div>
                                    <div class="student-level" style="background: var(--primary-blue); color: white; padding: 8px 16px; border-radius: 20px; font-weight: 600; font-size: 14px;">
                                        <i class="fas fa-star"></i> Estudante Ativo
                                    </div>
                                </div>
                            </div>

                            <!-- Informa√ß√µes do Aluno -->
                            <div style="background: #ffffff; padding: 25px; border-radius: var(--border-radius-lg); margin-bottom: 25px; border: 2px solid rgba(241, 196, 15, 0.3); box-shadow: var(--shadow-sm);">
                                <div style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
                                    <div class="avatar-container" style="position: relative;">
                                        <div style="width: 100px; height: 100px; border-radius: 50%; background: var(--primary-blue); display: flex; align-items: center; justify-content: center; font-size: 42px; font-weight: 800; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.2); border: 4px solid white;">
                                            <span id="alunoInitial">JS</span>
                                        </div>
                                        <div class="avatar-badge" style="position: absolute; bottom: 0; right: 0; background: var(--primary-yellow); width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 3px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
                                            <i class="fas fa-graduation-cap" style="color: #000; font-size: 14px;"></i>
                                        </div>
                                    </div>
                                    <div style="flex: 1; min-width: 200px;">
                                        <h2 style="color: var(--text-dark); font-size: 24px; font-weight: 700; margin-bottom: 8px;" id="alunoPerfilNome">Jo√£o da Silva</h2>
                                        <div style="color: var(--text-medium); font-size: 15px; margin-bottom: 8px;" id="alunoPerfilInfo">Matr√≠cula: 2025001 ‚Ä¢ Turma: 3¬∫A</div>
                                        <div style="display: inline-flex; align-items: center; gap: 8px; background: var(--primary-blue); color: white; padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 600;">
                                            <i class="fas fa-chart-line"></i>
                                            <span>Desempenho: <strong>Bom</strong></span>
                                        </div>
                                    </div>
                                    <!-- Op√ß√µes de Acessibilidade -->
                                    <div class="bd-toolbar" role="region" aria-label="Op√ß√µes de acessibilidade" style="display: flex; gap: 8px; flex-wrap: wrap; margin-left: auto;">
                                        <button type="button" class="bd-btn" data-action="font-dec" aria-label="Diminuir texto" style="background: rgba(52, 152, 219, 0.1); color: var(--primary-blue); border: 1px solid rgba(52, 152, 219, 0.3); padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">A‚àí</button>
                                        <button type="button" class="bd-btn" data-action="font-inc" aria-label="Aumentar texto" style="background: rgba(52, 152, 219, 0.1); color: var(--primary-blue); border: 1px solid rgba(52, 152, 219, 0.3); padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">A+</button>
                                        <button type="button" class="bd-btn" data-action="contrast" aria-label="Alto contraste" style="background: rgba(52, 152, 219, 0.1); color: var(--primary-blue); border: 1px solid rgba(52, 152, 219, 0.3); padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">‚óê</button>
                                        <button type="button" class="bd-btn" data-action="dyslexia" aria-label="Fonte para dislexia" style="background: rgba(52, 152, 219, 0.1); color: var(--primary-blue); border: 1px solid rgba(52, 152, 219, 0.3); padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">ùëì</button>
                                        <button type="button" class="bd-btn" data-action="reduce-motion" aria-label="Reduzir anima√ß√µes" style="background: rgba(52, 152, 219, 0.1); color: var(--primary-blue); border: 1px solid rgba(52, 152, 219, 0.3); padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">‚óé</button>
                                        <button type="button" class="bd-btn" data-action="print" aria-label="Exportar PDF" style="background: var(--primary-blue); color: white; border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;"><i class="fas fa-print"></i></button>
                                    </div>
                                </div>
                            </div>
                            
                            <h3 class="boletim-title" style="text-align: center; color: var(--primary-blue); font-size: 24px; margin-bottom: 25px; font-weight: 700;"><i class="fas fa-clipboard-list"></i> Boletim Escolar</h3>
                            
                            <!-- Indicador de Bimestre Atual -->
                            <div style="background: var(--primary-yellow); color: #000; padding: 15px 25px; border-radius: var(--border-radius-md); margin-bottom: 25px; text-align: center; font-weight: 700; font-size: 18px; box-shadow: var(--shadow-sm);">
                                <i class="fas fa-calendar-alt"></i> Bimestre Atual: <span id="bimestreAtualAluno">1¬∫ Bimestre</span>
                            </div>
                            
                            <div class="tab-headers" style="pointer-events: none; opacity: 0.7;">
                                <div class="tab-header"><strong><i class="fas fa-book"></i> Disciplina</strong></div>
                                <div class="tab-header active"><i class="fas fa-edit"></i> Simulado 1</div>
                                <div class="tab-header"><i class="fas fa-edit"></i> Simulado 2</div>
                                <div class="tab-header"><i class="fas fa-edit"></i> Simulado 3</div>
                                <div class="tab-header"><i class="fas fa-edit"></i> Simulado 4</div>
                            </div>

                            <table class="grades-table">
                                <tr>
                                    <td class="subject-cell">Portugu√™s</td>
                                    <td class="grade-cell grade-bom">Bom</td>
                                    <td class="grade-cell grade-insatisfatorio">Insatisfat√≥rio</td>
                                    <td class="grade-cell grade-regular">Regular</td>
                                    <td class="grade-cell grade-excelente">Excelente</td>
                                </tr>
                                <tr>
                                    <td class="subject-cell">Matem√°tica</td>
                                    <td class="grade-cell grade-bom">Bom</td>
                                    <td class="grade-cell grade-regular">Regular</td>
                                    <td class="grade-cell grade-excelente">Excelente</td>
                                    <td class="grade-cell grade-bom">Bom</td>
                                </tr>
                                <tr>
                                    <td class="subject-cell">Ci√™ncias</td>
                                    <td class="grade-cell grade-excelente">Excelente</td>
                                    <td class="grade-cell grade-bom">Bom</td>
                                    <td class="grade-cell grade-insatisfatorio">Insatisfat√≥rio</td>
                                    <td class="grade-cell grade-regular">Regular</td>
                                </tr>
                            </table>

                            <!-- √çndice de M√©dia -->
                            <div class="media-index-container media-index-small" id="mediaIndexAluno">
                                <div class="media-index-header">
                                    <h3 class="media-index-title"><i class="fas fa-chart-pie"></i> √çndice de M√©dia</h3>
                                </div>
                                <div class="media-index-grid">
                                    <div class="media-index-item media-excelente">
                                        <div class="media-icon">
                                            <i class="fas fa-star"></i>
                                        </div>
                                        <div class="media-content">
                                            <div class="media-label">Excelente</div>
                                            <div class="media-value" id="mediaExcelenteAluno">0</div>
                                            <div class="media-percentage" id="mediaExcelentePctAluno">0%</div>
                                        </div>
                                    </div>
                                    <div class="media-index-item media-bom">
                                        <div class="media-icon">
                                            <i class="fas fa-check-circle"></i>
                                        </div>
                                        <div class="media-content">
                                            <div class="media-label">Bom</div>
                                            <div class="media-value" id="mediaBomAluno">0</div>
                                            <div class="media-percentage" id="mediaBomPctAluno">0%</div>
                                        </div>
                                    </div>
                                    <div class="media-index-item media-atencao">
                                        <div class="media-icon">
                                            <i class="fas fa-exclamation-triangle"></i>
                                        </div>
                                        <div class="media-content">
                                            <div class="media-label">Aten√ß√£o</div>
                                            <div class="media-value" id="mediaAtencaoAluno">0</div>
                                            <div class="media-percentage" id="mediaAtencaoPctAluno">0%</div>
                                        </div>
                                    </div>
                                    <div class="media-index-item media-ruim">
                                        <div class="media-icon">
                                            <i class="fas fa-times-circle"></i>
                                        </div>
                                        <div class="media-content">
                                            <div class="media-label">Ruim</div>
                                            <div class="media-value" id="mediaRuimAluno">0</div>
                                            <div class="media-percentage" id="mediaRuimPctAluno">0%</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="media-index-summary">
                                    <div class="media-total">
                                        <span class="media-total-label">Total de Notas:</span>
                                        <span class="media-total-value" id="mediaTotalAluno">0</span>
                                    </div>
                                    <div class="media-average">
                                        <span class="media-average-label">M√©dia Geral:</span>
                                        <span class="media-average-value" id="mediaGeralAluno">-</span>
                                    </div>
                                </div>
                            </div>

                            <div class="status-section">
                                <h2 class="status-title"><i class="fas fa-chart-bar"></i> Status</h2>
                                <div class="status-indicators">
                                    <div class="status-indicator status-muito-bem"><i class="fas fa-star"></i> Est√° muito bem</div>
                                    <div class="status-indicator status-bem"><i class="fas fa-check-circle"></i> Est√° bem</div>
                                    <div class="status-indicator status-atencao"><i class="fas fa-exclamation-triangle"></i> Requer aten√ß√£o</div>
                                    <div class="status-indicator status-mal"><i class="fas fa-times-circle"></i> Est√° mal</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SE√á√ÉO CALEND√ÅRIO -->
                    <div id="alunoCalendarioSection" style="display: none;">
                        <div class="professor-dashboard-container">
                            <div class="professor-header">
                                <h1 class="professor-title">Meu Calend√°rio Escolar</h1>
                            </div>

                            <div class="calendar-container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-top: 25px;">
                                <div class="calendar-events" style="background: #ffffff; padding: 25px; border-radius: var(--border-radius-lg); border: 2px solid rgba(52, 152, 219, 0.3); box-shadow: var(--shadow-sm);">
                                    <h3 style="color: var(--primary-blue); font-size: 20px; font-weight: 700; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-calendar"></i> Pr√≥ximos Eventos</h3>
                                    <div class="event-list">
                                        <div class="event-item upcoming">
                                            <div class="event-date">
                                                <span class="day">25</span>
                                                <span class="month">NOV</span>
                                            </div>
                                            <div class="event-info">
                                                <h4>Simulado de Matem√°tica</h4>
                                                <p><i class="fas fa-edit"></i> Avalia√ß√£o bimestral</p>
                                                <span class="event-time">08:00 - 10:00</span>
                                            </div>
                                        </div>
                                        
                                        <div class="event-item upcoming">
                                            <div class="event-date">
                                                <span class="day">28</span>
                                                <span class="month">NOV</span>
                                            </div>
                                            <div class="event-info">
                                                <h4>Simulado de Portugu√™s</h4>
                                                <p><i class="fas fa-edit"></i> Avalia√ß√£o bimestral</p>
                                                <span class="event-time">08:00 - 10:00</span>
                                            </div>
                                        </div>
                                        
                                        <div class="event-item completed">
                                            <div class="event-date">
                                                <span class="day">20</span>
                                                <span class="month">NOV</span>
                                            </div>
                                            <div class="event-info">
                                                <h4>Simulado de Ci√™ncias</h4>
                                                <p>Conclu√≠do</p>
                                                <span class="event-result">Resultado: Bom</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="calendar-stats" style="background: #ffffff; padding: 25px; border-radius: var(--border-radius-lg); border: 2px solid rgba(241, 196, 15, 0.3); box-shadow: var(--shadow-sm);">
                                    <h3 style="color: var(--primary-blue); font-size: 20px; font-weight: 700; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;"><i class="fas fa-chart-bar"></i> Estat√≠sticas do M√™s</h3>
                                    <div class="stats-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                        <div class="stat-item" style="text-align: center; padding: 20px; background: white; border-radius: var(--border-radius-md); border: 2px solid rgba(52, 152, 219, 0.1); transition: all 0.3s ease;">
                                            <div class="stat-icon" style="font-size: 32px; color: var(--primary-blue); margin-bottom: 10px;"><i class="fas fa-book"></i></div>
                                            <div class="stat-value" style="font-size: 28px; font-weight: 800; color: var(--text-dark); margin-bottom: 5px;">15</div>
                                            <div class="stat-label" style="color: var(--text-medium); font-size: 14px; font-weight: 600;">Aulas</div>
                                        </div>
                                        <div class="stat-item" style="text-align: center; padding: 20px; background: white; border-radius: var(--border-radius-md); border: 2px solid rgba(52, 152, 219, 0.1); transition: all 0.3s ease;">
                                            <div class="stat-icon" style="font-size: 32px; color: var(--primary-green); margin-bottom: 10px;"><i class="fas fa-check-circle"></i></div>
                                            <div class="stat-value" style="font-size: 28px; font-weight: 800; color: var(--text-dark); margin-bottom: 5px;">14</div>
                                            <div class="stat-label" style="color: var(--text-medium); font-size: 14px; font-weight: 600;">Presentes</div>
                                        </div>
                                        <div class="stat-item" style="text-align: center; padding: 20px; background: white; border-radius: var(--border-radius-md); border: 2px solid rgba(52, 152, 219, 0.1); transition: all 0.3s ease;">
                                            <div class="stat-icon" style="font-size: 32px; color: var(--primary-blue); margin-bottom: 10px;"><i class="fas fa-edit"></i></div>
                                            <div class="stat-value" style="font-size: 28px; font-weight: 800; color: var(--text-dark); margin-bottom: 5px;">3</div>
                                            <div class="stat-label" style="color: var(--text-medium); font-size: 14px; font-weight: 600;">Simulados</div>
                                        </div>
                                        <div class="stat-item" style="text-align: center; padding: 20px; background: white; border-radius: var(--border-radius-md); border: 2px solid rgba(52, 152, 219, 0.1); transition: all 0.3s ease;">
                                            <div class="stat-icon" style="font-size: 32px; color: var(--primary-blue); margin-bottom: 10px;"><i class="fas fa-bullseye"></i></div>
                                            <div class="stat-value" style="font-size: 28px; font-weight: 800; color: var(--text-dark); margin-bottom: 5px;">93%</div>
                                            <div class="stat-label" style="color: var(--text-medium); font-size: 14px; font-weight: 600;">Frequ√™ncia</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="alunoPerfilSection" style="display: none;">
                        <div class="professor-dashboard-container">
                            <div class="professor-header">
                                <h1 class="professor-title">Meu Perfil</h1>
                            </div>
                            
                            <div style="text-align: center; padding: 40px 20px;">
                                <div style="position: relative; display: inline-block; margin-bottom: 25px;">
                                    <div style="width: 150px; height: 150px; border-radius: 50%; background: var(--primary-blue); display: flex; align-items: center; justify-content: center; font-size: 64px; font-weight: 800; color: white; box-shadow: 0 8px 25px rgba(0,0,0,0.2); border: 6px solid white; cursor: pointer; transition: all 0.3s ease;" onclick="changePhoto()" id="alunoPerfilAvatar">
                                        <span id="alunoPerfilInitial">JS</span>
                                    </div>
                                    <div style="position: absolute; bottom: 10px; right: 10px; background: var(--primary-yellow); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 4px solid white; box-shadow: 0 4px 12px rgba(0,0,0,0.2); cursor: pointer;" onclick="changePhoto()">
                                        <i class="fas fa-camera" style="color: #000; font-size: 16px;"></i>
                                    </div>
                                </div>
                                <h2 style="color: var(--text-dark); font-size: 28px; font-weight: 700; margin-bottom: 10px;" id="alunoPerfilNome">Jo√£o da Silva</h2>
                                <div style="display: inline-block; background: var(--primary-blue); color: white; padding: 8px 20px; border-radius: 20px; font-size: 15px; font-weight: 600; margin-bottom: 30px;">
                                    Aluno - 3¬™ S√©rie A
                                </div>
                            </div>
                            
                            <div style="text-align: center; display: flex; gap: 15px; justify-content: center; margin-top: 30px;">
                                <button class="btn btn-edit" onclick="editAlunoProfile()">
                                    <i class="fas fa-edit" style="margin-right: 8px;"></i>
                                    Editar Perfil
                                </button>
                                <button class="btn btn-save" onclick="saveAlunoProfile()">
                                    <i class="fas fa-save" style="margin-right: 8px;"></i>
                                    Salvar
                                </button>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <div class="corner-decoration bottom-left"></div>
        <div class="corner-decoration bottom-right"></div>
    </div>

    <script src="script.js"></script>
    <script>
        // Fun√ß√£o de navega√ß√£o para p√°ginas separadas
        function navigateToPage(page) {
            window.location.href = page;
        }

        // Fun√ß√£o para mostrar se√ß√µes do aluno
        function showAlunoSection(section) {
            // Esconder todas as se√ß√µes
            document.querySelectorAll('[id$="Section"]').forEach(sec => {
                sec.style.display = 'none';
            });
            
            // Remover classe active de todos os itens do menu
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Mostrar se√ß√£o selecionada
            const targetSection = document.getElementById(`aluno${section.charAt(0).toUpperCase() + section.slice(1)}Section`);
            if (targetSection) {
                targetSection.style.display = 'block';
                
                // Recalcular m√©dia se for a se√ß√£o de notas
                if (section === 'notas') {
                    setTimeout(() => calcularMediaIndice(), 100);
                }
            }
            
            // Adicionar classe active ao item do menu
            const clickedItem = event.target.closest('.menu-item-figma') || event.target.closest('.menu-item');
            if (clickedItem) {
                clickedItem.classList.add('active');
            }
        }

        // Fun√ß√£o para calcular √≠ndice de m√©dia
        function calcularMediaIndice() {
            const table = document.querySelector('#alunoNotasSection .grades-table');
            if (!table) return;

            let excelente = 0, bom = 0, atencao = 0, ruim = 0;
            const rows = table.querySelectorAll('tr');

            rows.forEach(row => {
                const cells = row.querySelectorAll('.grade-cell');
                cells.forEach(cell => {
                    const text = cell.textContent.trim();
                    if (text === 'Excelente') excelente++;
                    else if (text === 'Bom') bom++;
                    else if (text === 'Regular') atencao++;
                    else if (text === 'Insatisfat√≥rio') ruim++;
                });
            });

            const total = excelente + bom + atencao + ruim;
            
            // Atualizar valores
            document.getElementById('mediaExcelenteAluno').textContent = excelente;
            document.getElementById('mediaBomAluno').textContent = bom;
            document.getElementById('mediaAtencaoAluno').textContent = atencao;
            document.getElementById('mediaRuimAluno').textContent = ruim;
            document.getElementById('mediaTotalAluno').textContent = total;

            // Calcular percentuais
            if (total > 0) {
                document.getElementById('mediaExcelentePctAluno').textContent = 
                    Math.round((excelente / total) * 100) + '%';
                document.getElementById('mediaBomPctAluno').textContent = 
                    Math.round((bom / total) * 100) + '%';
                document.getElementById('mediaAtencaoPctAluno').textContent = 
                    Math.round((atencao / total) * 100) + '%';
                document.getElementById('mediaRuimPctAluno').textContent = 
                    Math.round((ruim / total) * 100) + '%';

                // Calcular m√©dia geral com pesos: Excelente=3, Bom=2, Aten√ß√£o=1, Ruim=0
                const somaPonderada = (excelente * 3) + (bom * 2) + (atencao * 1) + (ruim * 0);
                const mediaGeral = total > 0 ? somaPonderada / total : 0;
                
                // Formatar m√©dia com 2 casas decimais
                const mediaFormatada = mediaGeral.toFixed(2);
                
                // Determinar classifica√ß√£o baseada na m√©dia (escala 0-3)
                // 0,0 a 0,4 ‚Üí Muito mal
                // 0,5 a 1,4 ‚Üí Aten√ß√£o
                // 1,5 a 2,4 ‚Üí Bom
                // 2,5 a 3,0 ‚Üí Excelente
                let mediaTexto = '';
                if (mediaGeral >= 2.5) mediaTexto = 'Excelente';
                else if (mediaGeral >= 1.5) mediaTexto = 'Bom';
                else if (mediaGeral >= 0.5) mediaTexto = 'Aten√ß√£o';
                else mediaTexto = 'Muito mal';

                document.getElementById('mediaGeralAluno').textContent = `${mediaFormatada} (${mediaTexto})`;
            } else {
                document.getElementById('mediaExcelentePctAluno').textContent = '0%';
                document.getElementById('mediaBomPctAluno').textContent = '0%';
                document.getElementById('mediaAtencaoPctAluno').textContent = '0%';
                document.getElementById('mediaRuimPctAluno').textContent = '0%';
                document.getElementById('mediaGeralAluno').textContent = '-';
            }
        }

        // Calcular m√©dia quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            calcularMediaIndice();
            
            // Determinar bimestre atual baseado na data
            const hoje = new Date();
            const mes = hoje.getMonth() + 1; // 1-12
            let bimestre = 1;
            if (mes >= 3 && mes <= 4) bimestre = 1;
            else if (mes >= 5 && mes <= 6) bimestre = 2;
            else if (mes >= 7 && mes <= 9) bimestre = 3;
            else if (mes >= 10 && mes <= 12) bimestre = 4;
            
            const bimestreElement = document.getElementById('bimestreAtualAluno');
            if (bimestreElement) {
                bimestreElement.textContent = `${bimestre}¬∫ Bimestre`;
            }
        });

        // Modificar fun√ß√£o logout para redirecionar
        function logout() {
            localStorage.removeItem('currentUser');
            showAlert('Logout realizado com sucesso!', 'success');
            setTimeout(() => navigateToPage('login.html'), 1500);
        }

        // Vari√°vel para controlar o modo de acessibilidade atual
        let currentAccessibilityMode = 'nenhum';

        // Fun√ß√£o para alternar acessibilidade
        function toggleAccessibility(mode) {
            const body = document.body;
            const daltonismoLegend = document.getElementById('daltonismoLegend');
            const pbLegend = document.getElementById('pbLegend');
            
            // Remover modos anteriores
            body.classList.remove('daltonismo-mode', 'preto-e-branco-mode');
            daltonismoLegend.classList.remove('show');
            pbLegend.classList.remove('show');
            
            currentAccessibilityMode = mode;
            
            if (mode === 'daltonismo') {
                body.classList.add('daltonismo-mode');
                daltonismoLegend.classList.add('show');
                showAlert('Modo Dalt√¥nico ativado! Legenda exibida.', 'success');
            } else if (mode === 'preto-e-branco') {
                body.classList.add('preto-e-branco-mode');
                pbLegend.classList.add('show');
                showAlert('Modo Preto e Branco ativado! Legenda exibida.', 'success');
            } else {
                showAlert('Modo de visualiza√ß√£o padr√£o restaurado.', 'success');
            }
            
            // Fechar menu de acessibilidade ap√≥s sele√ß√£o
            document.getElementById('accessibilityOptions').classList.remove('show');
        }
        
        // Fun√ß√£o para alternar legenda de daltonismo
        function toggleLegend() {
            const legend = document.getElementById('daltonismoLegend');
            legend.classList.toggle('show');
        }
        
        // Fun√ß√£o para alternar legenda P&B
        function togglePbLegend() {
            const legend = document.getElementById('pbLegend');
            legend.classList.toggle('show');
        }
        
        // Fechar legendas ao clicar no overlay (pseudo-elemento)
        document.addEventListener('click', function(e) {
            const daltonismoLegend = document.getElementById('daltonismoLegend');
            const pbLegend = document.getElementById('pbLegend');
            const legendToggle = document.querySelector('.legend-toggle');
            const pbLegendToggle = document.querySelector('.pb-legend-toggle');
            
            // Se a legenda est√° aberta e o clique foi fora dela
            if (daltonismoLegend && daltonismoLegend.classList.contains('show')) {
                if (!daltonismoLegend.contains(e.target) && e.target !== legendToggle && !legendToggle.contains(e.target)) {
                    daltonismoLegend.classList.remove('show');
                }
            }
            
            if (pbLegend && pbLegend.classList.contains('show')) {
                if (!pbLegend.contains(e.target) && e.target !== pbLegendToggle && !pbLegendToggle.contains(e.target)) {
                    pbLegend.classList.remove('show');
                }
            }
        });
        
        // Fechar legendas com ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const daltonismoLegend = document.getElementById('daltonismoLegend');
                const pbLegend = document.getElementById('pbLegend');
                if (daltonismoLegend) daltonismoLegend.classList.remove('show');
                if (pbLegend) pbLegend.classList.remove('show');
            }
        });
        
        // Toggle do menu de acessibilidade
        document.addEventListener('DOMContentLoaded', function() {
            const accessibilityToggle = document.querySelector('.accessibility-toggle');
            const accessibilityOptions = document.getElementById('accessibilityOptions');
            
            if (accessibilityToggle) {
                accessibilityToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    accessibilityOptions.classList.toggle('show');
                });
            }
            
            // Fechar menu ao clicar fora
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.accessibility-menu')) {
                    accessibilityOptions.classList.remove('show');
                }
            });
            
            // Carregar dados do usu√°rio do localStorage
            const userData = localStorage.getItem('currentUser');
            if (!userData) {
                navigateToPage('login.html');
                return;
            }

            const currentUser = JSON.parse(userData);
            if (currentUser.type !== 'aluno') {
                navigateToPage('login.html');
                return;
            }

            // Atualizar informa√ß√µes do perfil
            const nomeElements = document.querySelectorAll('#alunoPerfilNome');
            const infoElement = document.getElementById('alunoPerfilInfo');
            const initialElement = document.getElementById('alunoInitial');
            
            nomeElements.forEach(el => {
                if (el) el.textContent = currentUser.name;
            });
            
            if (infoElement) {
                infoElement.textContent = `Matr√≠cula: ${currentUser.matricula} ‚Ä¢ Turma: ${currentUser.serie}¬™${currentUser.turma}`;
            }
            
            // Gerar iniciais do aluno para o avatar
            if (currentUser.name) {
                const names = currentUser.name.trim().split(' ');
                let initials = '';
                if (names.length >= 2) {
                    initials = names[0].charAt(0).toUpperCase() + names[names.length - 1].charAt(0).toUpperCase();
                } else if (names.length === 1 && names[0].length >= 2) {
                    initials = names[0].charAt(0).toUpperCase() + names[0].charAt(1).toUpperCase();
                } else {
                    initials = names[0].charAt(0).toUpperCase() + 'A';
                }
                
                // Atualizar todos os elementos de inicial
                const initialElements = document.querySelectorAll('#alunoInitial, #alunoPerfilInitial');
                initialElements.forEach(el => {
                    if (el) el.textContent = initials || 'AL';
                });
            }
            
            // Funcionalidade dos bot√µes da toolbar
            const toolbar = document.querySelector('.bd-toolbar');
            if (toolbar) {
                toolbar.addEventListener('click', function(e) {
                    const btn = e.target.closest('.bd-btn');
                    if (!btn) return;
                    
                    const action = btn.dataset.action;
                    
                    switch(action) {
                        case 'font-dec':
                            adjustFontSize(-1);
                            break;
                        case 'font-inc':
                            adjustFontSize(1);
                            break;
                        case 'contrast':
                            toggleHighContrast();
                            break;
                        case 'dyslexia':
                            toggleDyslexiaFont();
                            break;
                        case 'reduce-motion':
                            toggleReducedMotion();
                            break;
                        case 'print':
                            exportBoletimPDF();
                            break;
                    }
                });
            }
        });
        
        // Fun√ß√µes auxiliares da toolbar
        let fontSize = 100;
        function adjustFontSize(delta) {
            fontSize = Math.max(80, Math.min(120, fontSize + delta * 10));
            document.documentElement.style.fontSize = fontSize + '%';
            showAlert(`Tamanho da fonte: ${fontSize}%`, 'success');
        }
        
        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
            const isActive = document.body.classList.contains('high-contrast');
            showAlert(isActive ? 'Alto contraste ativado' : 'Alto contraste desativado', 'success');
        }
        
        function toggleDyslexiaFont() {
            document.body.classList.toggle('dyslexia-font');
            const isActive = document.body.classList.contains('dyslexia-font');
            showAlert(isActive ? 'Fonte para dislexia ativada' : 'Fonte padr√£o restaurada', 'success');
        }
        
        function toggleReducedMotion() {
            document.body.classList.toggle('reduced-motion');
            const isActive = document.body.classList.contains('reduced-motion');
            showAlert(isActive ? 'Anima√ß√µes reduzidas' : 'Anima√ß√µes restauradas', 'success');
        }
        

        function exportBoletimPDF() {
            const userData = localStorage.getItem('currentUser');
            if (!userData) {
                showAlert('Erro: Usu√°rio n√£o encontrado!', 'error');
                return;
            }

            const currentUser = JSON.parse(userData);
            showAlert('Gerando PDF do boletim...', 'success');
            
            // Dados do boletim
            const disciplinas = [
                { nome: 'Portugu√™s', sim1: 'Bom', sim2: 'Insatisfat√≥rio', sim3: 'Regular', sim4: 'Excelente' },
                { nome: 'Matem√°tica', sim1: 'Bom', sim2: 'Regular', sim3: 'Excelente', sim4: 'Bom' },
                { nome: 'Ci√™ncias', sim1: 'Excelente', sim2: 'Bom', sim3: 'Insatisfat√≥rio', sim4: 'Regular' }
            ];
            
            // Criar conte√∫do HTML para o PDF
            let htmlContent = `
                <html>
                <head>
                    <style>
                        body { 
                            font-family: 'Segoe UI', Arial, sans-serif; 
                            padding: 40px; 
                            background: #f8f9fa; 
                        }
                        .container { 
                            background: white; 
                            padding: 40px; 
                            border-radius: 15px; 
                            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); 
                        }
                        h1 { 
                            color: #D4AF37; 
                            text-align: center; 
                            margin-bottom: 10px; 
                            font-size: 32px;
                            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
                        }
                        h2 { 
                            color: #C19A2B; 
                            text-align: center;
                            margin-bottom: 30px; 
                            font-size: 18px; 
                        }
                        .info-section { 
                            background: linear-gradient(135deg, #f5f3e8, #ede8d5); 
                            padding: 20px; 
                            border-radius: 12px; 
                            margin-bottom: 25px;
                            border-left: 5px solid #D4AF37;
                        }
                        .info-section p { 
                            margin: 8px 0; 
                            color: #555; 
                        }
                        table { 
                            width: 100%; 
                            border-collapse: separate; 
                            border-spacing: 0; 
                            margin-top: 25px;
                            border-radius: 12px;
                            overflow: hidden;
                            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.08);
                        }
                        th { 
                            background: linear-gradient(135deg, #D4AF37, #C19A2B); 
                            color: white; 
                            padding: 15px 12px; 
                            text-align: center;
                            font-weight: 600;
                            font-size: 13px;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                        }
                        th:first-child {
                            text-align: left;
                        }
                        td { 
                            border-bottom: 1px solid #e0e0e0; 
                            padding: 14px 12px;
                            background: white;
                            color: #333;
                            text-align: center;
                        }
                        td:first-child {
                            text-align: left;
                            font-weight: 600;
                            color: #C19A2B;
                        }
                        tr:nth-child(even) td { 
                            background: #fafafa; 
                        }
                        tr:last-child td { 
                            border-bottom: none; 
                        }
                        
                        .nota-cell {
                            display: inline-block;
                            padding: 8px 20px;
                            border-radius: 25px;
                            font-weight: bold;
                            font-size: 12px;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
                            border: 2px solid transparent;
                        }
                        
                        .nota-excelente { 
                            background: linear-gradient(135deg, #4CAF50, #45a049); 
                            color: white;
                            border-color: #388E3C;
                        }
                        .nota-bom { 
                            background: linear-gradient(135deg, #2196F3, #1976D2); 
                            color: white;
                            border-color: #1565C0;
                        }
                        .nota-regular { 
                            background: linear-gradient(135deg, #FF9800, #F57C00); 
                            color: white;
                            border-color: #E65100;
                        }
                        .nota-insatisfatorio { 
                            background: linear-gradient(135deg, #F44336, #D32F2F); 
                            color: white;
                            border-color: #B71C1C;
                        }
                        
                        .legenda {
                            display: flex;
                            justify-content: center;
                            gap: 20px;
                            margin: 30px 0 20px 0;
                            padding: 15px;
                            background: #f5f3e8;
                            border-radius: 10px;
                        }
                        .legenda-item {
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            font-size: 12px;
                        }
                        .legenda-color {
                            width: 25px;
                            height: 25px;
                            border-radius: 50%;
                            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
                        }
                        
                        .footer { 
                            margin-top: 40px; 
                            text-align: center; 
                            font-size: 12px; 
                            color: #888;
                            padding-top: 30px;
                            border-top: 2px solid #D4AF37;
                        }
                        .footer p { 
                            margin: 5px 0; 
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <h1><i class="fas fa-clipboard-list"></i> Boletim Escolar</h1>
                        <h2>Sistema Escolar JK</h2>
                        
                        <div class="info-section">
                            <p><strong>Aluno:</strong> ${currentUser.name}</p>
                            <p><strong>Matr√≠cula:</strong> ${currentUser.matricula}</p>
                            <p><strong>Turma:</strong> ${currentUser.serie}¬™ S√©rie ${currentUser.turma}</p>
                            <p><strong>Data de Emiss√£o:</strong> ${new Date().toLocaleDateString('pt-BR')} √†s ${new Date().toLocaleTimeString('pt-BR')}</p>
                        </div>
                        
                        <div class="legenda">
                            <div class="legenda-item">
                                <div class="legenda-color" style="background: linear-gradient(135deg, #4CAF50, #45a049);"></div>
                                <span><strong>Excelente</strong></span>
                            </div>
                            <div class="legenda-item">
                                <div class="legenda-color" style="background: linear-gradient(135deg, #2196F3, #1976D2);"></div>
                                <span><strong>Bom</strong></span>
                            </div>
                            <div class="legenda-item">
                                <div class="legenda-color" style="background: linear-gradient(135deg, #FF9800, #F57C00);"></div>
                                <span><strong>Regular</strong></span>
                            </div>
                            <div class="legenda-item">
                                <div class="legenda-color" style="background: linear-gradient(135deg, #F44336, #D32F2F);"></div>
                                <span><strong>Insatisfat√≥rio</strong></span>
                            </div>
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Disciplina</th>
                                    <th>Simulado 1</th>
                                    <th>Simulado 2</th>
                                    <th>Simulado 3</th>
                                    <th>Simulado 4</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${disciplinas.map(disc => {
                                    const getClass = (nota) => {
                                        if (nota === 'Excelente') return 'nota-excelente';
                                        if (nota === 'Bom') return 'nota-bom';
                                        if (nota === 'Regular') return 'nota-regular';
                                        return 'nota-insatisfatorio';
                                    };
                                    
                                    return `
                                    <tr>
                                        <td>${disc.nome}</td>
                                        <td><span class="nota-cell ${getClass(disc.sim1)}">${disc.sim1}</span></td>
                                        <td><span class="nota-cell ${getClass(disc.sim2)}">${disc.sim2}</span></td>
                                        <td><span class="nota-cell ${getClass(disc.sim3)}">${disc.sim3}</span></td>
                                        <td><span class="nota-cell ${getClass(disc.sim4)}">${disc.sim4}</span></td>
                                    </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                        
                        <div class="footer">
                            <p><strong>Sistema Escolar JK - Gest√£o Acad√™mica</strong></p>
                            <p>Boletim gerado automaticamente</p>
                            <p>${new Date().toLocaleString('pt-BR')}</p>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            // Criar e fazer download do PDF
            const printWindow = window.open('', '', 'height=800,width=1000');
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
                showAlert('PDF gerado! Use a op√ß√£o "Salvar como PDF" na janela de impress√£o.', 'success');
            }, 500);
        }
    </script>
</body>
</html>
